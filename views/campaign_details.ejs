
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= campaign.title %> - Campaign Details</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css">
    <style>
        :root {
            --primary: #4361ee;
            --primary-dark: #3a56d4;
            --secondary: #3f37c9;
            --success: #4cc9f0;
            --warning: #f8961e;
            --danger: #f72585;
            --dark: #212529;
            --light: #f8f9fa;
        }
        
        body {
            background-color: #f8f9fa;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            line-height: 1.6;
        }
        
        /* Hero Banner */
        .campaign-hero {
            height: 500px;
            background-size: cover;
            background-position: center;
            position: relative;
            overflow: hidden;
            border-radius: 0 0 20px 20px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
        }
        
        .campaign-hero::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 200px;
            background: linear-gradient(to top, rgba(0,0,0,0.9), transparent);
        }
        
        .hero-content {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 2;
            color: white;
            padding: 3rem;
        }
        
        /* Token Badges */
        .token-badge {
            display: inline-flex;
            align-items: center;
            padding: 0.35rem 0.8rem;
            border-radius: 50px;
            font-weight: 600;
            font-size: 0.8rem;
            letter-spacing: 0.5px;
        }
        
        .badge-profit { background-color: var(--success); color: #000; }
        .badge-ownership { background-color: var(--primary); color: #fff; }
        .badge-rewards { background-color: var(--warning); color: #000; }
        .badge-hybrid { background-color: #198754; color: #fff; }
        
        /* Main Content Card */
        .content-card {
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08);
            margin-top: -80px;
            position: relative;
            z-index: 3;
            padding: 2.5rem;
            margin-bottom: 3rem;
        }
        
        /* Progress Bar */
        .funding-progress {
            margin: 2rem 0;
        }
        
        .progress {
            height: 12px;
            border-radius: 10px;
            background-color: #e9ecef;
        }
        
        .progress-bar {
            background: linear-gradient(90deg, var(--primary), var(--success));
            border-radius: 10px;
            transition: width 1s ease-in-out;
        }
        
        /* Tokenomics Section */
        .tokenomics-card {
            background: linear-gradient(135deg, rgba(67, 97, 238, 0.05), rgba(76, 201, 240, 0.05));
            border-radius: 16px;
            padding: 2rem;
            margin: 2rem 0;
            border-left: 4px solid var(--primary);
        }
        
        .tokenomics-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 1.5rem;
        }
        
        .tokenomics-icon {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background-color: rgba(67, 97, 238, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 1.2rem;
            color: var(--primary);
            font-size: 1.2rem;
            flex-shrink: 0;
        }
        
        /* Investment Card */
        .investment-card {
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: none;
            transition: all 0.3s ease;
            position: sticky;
            top: 20px;
        }
        
        .investment-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
        }
        
        /* Calculator */
        .token-calculator {
            background: rgba(248, 249, 250, 0.8);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }
        
        .calculator-result {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--primary);
            text-align: center;
            padding: 1rem;
            background: white;
            border-radius: 10px;
            margin-top: 1rem;
            border: 1px dashed rgba(67, 97, 238, 0.3);
        }
        
        /* Investors Section */
        .investors-section {
            margin-top: 4rem;
            padding-top: 3rem;
            border-top: 1px solid rgba(0,0,0,0.05);
        }
        
        .investor-card {
            background: white;
            border-radius: 14px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
        }
        
        .investor-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border-left-color: var(--primary);
        }
        
        .investor-avatar {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        /* Timeline */
        .timeline {
            position: relative;
            padding-left: 30px;
            margin: 2rem 0;
        }
        
        .timeline::before {
            content: '';
            position: absolute;
            left: 10px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: rgba(0,0,0,0.1);
        }
        
        .timeline-item {
            position: relative;
            padding-bottom: 2rem;
        }
        
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -30px;
            top: 5px;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: var(--primary);
            border: 3px solid white;
            box-shadow: 0 0 0 2px var(--primary);
        }
        
        /* Buttons */
        .btn-invest {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            border: none;
            font-weight: 600;
            letter-spacing: 0.5px;
            padding: 1rem 2rem;
            border-radius: 12px;
            transition: all 0.3s;
        }
        
        .btn-invest:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(67, 97, 238, 0.3);
        }
        
        /* Section Titles */
        .section-title {
            position: relative;
            padding-bottom: 1rem;
            margin-bottom: 2rem;
        }
        
        .section-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 60px;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--success));
            border-radius: 4px;
        }
        
        /* Responsive Adjustments */
        @media (max-width: 992px) {
            .campaign-hero {
                height: 400px;
            }
            
            .content-card {
                margin-top: -60px;
            }
        }
        
        @media (max-width: 768px) {
            .campaign-hero {
                height: 350px;
            }
            
            .hero-content {
                padding: 2rem;
            }
            
            .content-card {
                padding: 1.5rem;
            }
        }
        
        /* Animations */
        [data-aos] {
            transition: all 0.8s ease;
        }
        
        /* Tooltips */
        .info-tooltip {
            position: relative;
            display: inline-block;
            cursor: pointer;
            margin-left: 0.3rem;
        }
        
        .info-tooltip .tooltip-text {
            visibility: hidden;
            width: 280px;
            background-color: var(--dark);
            color: #fff;
            text-align: center;
            border-radius: 8px;
            padding: 10px;
            position: absolute;
            z-index: 100;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.85rem;
            font-weight: normal;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .info-tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }
        
        /* Risk Meter */
        .risk-meter {
            height: 10px;
            background: #e9ecef;
            border-radius: 10px;
            overflow: hidden;
            margin: 1rem 0;
            position: relative;
        }
        
        .risk-level {
            height: 100%;
            width: 30%;
            background: linear-gradient(90deg, #4cc9f0, #f8961e);
            border-radius: 10px;
        }
        
        .risk-labels {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            color: #6c757d;
        }

  .star-rating i {
    font-size: 24px;
    cursor: pointer;
    margin-right: 5px;
  }
</style>

    </style>
</head>
<body>

    <div class="container">
        <% if(error && error.length >0){ %>
           <div class="alert alert-danger" role="alert">
               <%= error %> 
           </div>
          <% } %> 
        <% if(success && success.length >0){ %>  
           <div class="alert alert-success" role="alert">
               <%= success %>
           </div>
           <% } %>
      </div>
    <!-- Hero Banner -->
    <div class="campaign-hero" style="background-image: url('<%= campaign.image || '/images/default-banner.jpg' %>');" data-aos="fade">
        <div class="hero-content">
            <div class="container">
                <div class="d-flex justify-content-between align-items-start flex-wrap">
                    <div>
                        <h1 class="display-4 fw-bold mb-3"><%= campaign.title %></h1>
                        <div class="d-flex align-items-center gap-3 mb-4">
                            <span class="token-badge badge-<%= campaign.tokenType %>">
                                <i class="bi bi-<%= 
                                    campaign.tokenType === 'profit' ? 'graph-up' : 
                                    campaign.tokenType === 'ownership' ? 'building' : 
                                    campaign.tokenType === 'rewards' ? 'gift' : 'collection'
                                %> me-1"></i>
                                <%= campaign.tokenType.toUpperCase() %> TOKENS
                            </span>
                            <span class="badge bg-light text-dark fs-6">
                                <i class="bi bi-<%= 
                                    campaign.status === 'active' ? 'lightning' : 
                                    campaign.status === 'funded' ? 'check-circle' : 'x-circle'
                                %> me-1"></i>
                                <%= campaign.status.toUpperCase() %>
                            </span>
                        </div>
                    </div>
                    <% if(currentUser && currentUser._id.equals(campaign.owner._id)) { %>
                        <div class="d-flex gap-2">
                            <button class="btn btn-outline-light" data-bs-toggle="modal" data-bs-target="#editCampaignModal">
                                <i class="bi bi-pencil"></i> Edit
                            </button>
                            <button class="btn btn-outline-light" onclick="confirmDelete('<%= campaign._id %>')">
                                <i class="bi bi-trash"></i> Delete
                            </button>
                        </div>
                    <% } %>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container" style="padding-top: 40px;">
        <div class="content-card" data-aos="fade-up">
            <div class="row">
                <!-- Left Column - Campaign Details -->
                <div class="col-lg-8">
                    <!-- Owner Section -->
                    <div class="d-flex align-items-center mb-5" data-aos="fade-right">
                        <img src="<%= campaign.owner.profilePicture || '/img_avatar1.png' %>" 
                             alt="<%= campaign.owner.username %>" 
                             class="investor-avatar me-4">
                        <div>
                            <h4 class="mb-1">
                                <%= campaign.owner.username %> <%= campaign.owner.surname %>
                                
                                <% if (campaign.owner.kycStatus === 'verified') { %>
                                    <span class="badge bg-primary-soft text-primary ms-2">
                                      <i class="bi bi-patch-check-fill"></i> Verified
                                    </span>
                                  <% } else if (campaign.owner.kycStatus === 'pending') { %>
                                    <span class="badge bg-warning-soft text-warning ms-2">
                                      <i class="bi bi-clock-history"></i> KYC Pending
                                    </span>
                                  <% } else { %>
                                    <span class="badge bg-secondary text-light ms-2">
                                      <i class="bi bi-question-circle"></i> Not Verified
                                    </span>
                                  <% } %>
                                  
                              </h4>
                              
                            <p class="text-muted mb-2">Campaign Creator</p>
                            <div class="d-flex gap-2">
                                <a href="#" class="btn btn-sm btn-outline-primary">
                                    <i class="bi bi-envelope"></i> Contact
                                </a>
                                <a href="/<%= campaign.owner._id %>/users/" class="btn btn-sm btn-outline-secondary">
                                    <i class="bi bi-person"></i> Profile
                                </a>
                            </div>
                        </div>
                    </div>

                    <!-- Funding Progress -->
                    <div class="funding-progress" data-aos="fade-up">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <div>
                                <h3 class="mb-0">$<%= campaign.amountRaised.toLocaleString() %></h3>
                                <small class="text-muted">raised of $<%= campaign.goalAmount.toLocaleString() %> goal</small>
                            </div>
                            <span class="badge bg-primary text-white px-3 py-2 fs-6">
                                <%= ((campaign.amountRaised / campaign.goalAmount) * 100).toFixed(2) %>% Funded
                            </span>
                        </div>
                        <div class="progress mb-3">
                            <div class="progress-bar" 
                                 role="progressbar" 
                                 style="width: <%= Math.min((campaign.amountRaised / campaign.goalAmount) * 100, 100) %>%" 
                                 aria-valuenow="<%= (campaign.amountRaised / campaign.goalAmount) * 100 %>">
                            </div>
                        </div>
                        <div class="d-flex justify-content-between text-muted">
                            <span><i class="bi bi-people me-1"></i> <%= campaign.investors ? campaign.investors.length : 0 %> Investors</span>
                            <span><i class="bi bi-calendar me-1"></i> Launched <%= new Date(campaign.timeCreated).toLocaleDateString() %></span>
                        </div>
                    </div>

                    <!-- Campaign Description -->
                    <div class="mb-5" data-aos="fade-up">
                        <h3 class="section-title">Campaign Story</h3>
                        <div class="campaign-description" style="white-space: pre-line;"><%= campaign.description %></div>
                    </div>

                    <!-- Tokenomics Section -->
                    <div class="tokenomics-card" data-aos="fade-up">
                        <h3 class="section-title text-primary"><i class="bi bi-coin me-2"></i>Token Details</h3>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="tokenomics-item">
                                    <div class="tokenomics-icon">
                                        <i class="bi bi-tag"></i>
                                    </div>
                                    <div>
                                        <h5 class="mb-1">Token Name</h5>
                                        <p class="mb-0 text-muted"><%= campaign.tokenName %></p>
                                    </div>
                                </div>
                                <div class="tokenomics-item">
                                    <div class="tokenomics-icon">
                                        <i class="bi bi-hash"></i>
                                    </div>
                                    <div>
                                        <h5 class="mb-1">Token Symbol</h5>
                                        <p class="mb-0 text-muted"><%= campaign.tokenSymbol %></p>
                                    </div>
                                </div>
                                <div class="tokenomics-item">
                                    <div class="tokenomics-icon">
                                        <i class="bi bi-stack"></i>
                                    </div>
                                    <div>
                                        <h5 class="mb-1">Total Supply</h5>
                                        <p class="mb-0 text-muted"><%= campaign.totalTokens.toLocaleString() %></p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <% if(campaign.tokenType === 'profit') { %>
                                    <div class="tokenomics-item">
                                        <div class="tokenomics-icon">
                                            <i class="bi bi-percent"></i>
                                        </div>
                                        <div>
                                            <h5 class="mb-1">Profit Share
                                                <span class="info-tooltip">
                                                    <i class="bi bi-info-circle"></i>
                                                    <span class="tooltip-text">Investors receive <%= campaign.tokenMetadata.profitSharePercentage %>% of project profits distributed proportionally to their token holdings</span>
                                                </span>
                                            </h5>
                                            <p class="mb-0 text-muted"><%= campaign.tokenMetadata.profitSharePercentage %>% of <%= campaign.tokenMetadata.profitBase === 'gross' ? 'gross revenue' : 'net profit' %></p>
                                        </div>
                                    </div>
                                    <div class="tokenomics-item">
                                        <div class="tokenomics-icon">
                                            <i class="bi bi-calendar-check"></i>
                                        </div>
                                        <div>
                                            <h5 class="mb-1">Distribution</h5>
                                            <p class="mb-0 text-muted"><%= campaign.tokenMetadata.profitDistributionFrequency.charAt(0).toUpperCase() + campaign.tokenMetadata.profitDistributionFrequency.slice(1) %> Payouts</p>
                                        </div>
                                    </div>
                                <% } else if(campaign.tokenType === 'ownership') { %>
                                    <div class="tokenomics-item">
                                        <div class="tokenomics-icon">
                                            <i class="bi bi-pie-chart"></i>
                                        </div>
                                        <div>
                                            <h5 class="mb-1">Ownership Stake
                                                <span class="info-tooltip">
                                                    <i class="bi bi-info-circle"></i>
                                                    <span class="tooltip-text">Total <%= campaign.tokenMetadata.ownershipPercentage %>% of the project is being offered to investors</span>
                                                </span>
                                            </h5>
                                            <p class="mb-0 text-muted"><%= campaign.tokenMetadata.ownershipPercentage %>% Equity</p>
                                        </div>
                                    </div>
                                    <div class="tokenomics-item">
                                        <div class="tokenomics-icon">
                                            <i class="bi bi-check-circle"></i>
                                        </div>
                                        <div>
                                            <h5 class="mb-1">Voting Rights</h5>
                                            <p class="mb-0 text-muted"><%= campaign.tokenMetadata.votingRights ? '✅ Included' : '❌ Not Included' %></p>
                                        </div>
                                    </div>
                                <% } else if(campaign.tokenType === 'rewards') { %>
                                    <div class="tokenomics-item">
                                        <div class="tokenomics-icon">
                                            <i class="bi bi-gift"></i>
                                        </div>
                                        <div>
                                            <h5 class="mb-1">Investor Rewards</h5>
                                            <p class="mb-0 text-muted"><%= campaign.tokenMetadata.rewardDescription.substring(0, 100) %><%= campaign.tokenMetadata.rewardDescription.length > 100 ? '...' : '' %></p>
                                        </div>
                                    </div>
                                <% } else if(campaign.tokenType === 'hybrid') { %>
                                    <div class="tokenomics-item">
                                        <div class="tokenomics-icon">
                                            <i class="bi bi-pie-chart"></i>
                                        </div>
                                        <div>
                                            <h5 class="mb-1">Ownership Per Token
                                                <span class="info-tooltip">
                                                    <i class="bi bi-info-circle"></i>
                                                    <span class="tooltip-text">Each token represents <%= campaign.tokenMetadata.ownershipPerToken %>% ownership in the project</span>
                                                </span>
                                            </h5>
                                            <p class="mb-0 text-muted"><%= campaign.tokenMetadata.ownershipPerToken %>% per token</p>
                                        </div>
                                    </div>
                                    <div class="tokenomics-item">
                                        <div class="tokenomics-icon">
                                            <i class="bi bi-gift"></i>
                                        </div>
                                        <div>
                                            <h5 class="mb-1">Additional Rewards</h5>
                                            <p class="mb-0 text-muted"><%= campaign.tokenMetadata.rewardDescription.substring(0, 100) %><%= campaign.tokenMetadata.rewardDescription.length > 100 ? '...' : '' %></p>
                                        </div>
                                    </div>
                                <% } %>
                            </div>
                        </div>
                    </div>

                    <!-- Risk Assessment -->
                    <div class="mb-5" data-aos="fade-up">
                        <h3 class="section-title">Risk Assessment</h3>
                        <div class="alert alert-warning">
                            <i class="bi bi-exclamation-triangle me-2"></i>
                            Investing in startups involves risks including illiquidity, lack of dividends, loss of investment and dilution.
                        </div>
                        
                        <div class="risk-meter">
                            <div class="risk-level" style="width: <%= 
                                campaign.tokenType === 'profit' ? '30%' : 
                                campaign.tokenType === 'ownership' ? '70%' : '50%'
                            %>"></div>
                        </div>
                        <div class="risk-labels">
                            <span>Low</span>
                            <span>Medium</span>
                            <span>High</span>
                        </div>
                        
                        <div class="mt-3">
                            <h5 class="mb-2">Risk Factors:</h5>
                            <ul class="list-unstyled">
                                <li class="mb-2"><i class="bi bi-dot text-danger me-2"></i>Market competition and adoption risks</li>
                                <li class="mb-2"><i class="bi bi-dot text-danger me-2"></i>Execution risk by the founding team</li>
                                <li class="mb-2"><i class="bi bi-dot text-danger me-2"></i>Regulatory changes affecting the industry</li>
                                <% if(campaign.tokenType === 'profit') { %>
                                    <li class="mb-2"><i class="bi bi-dot text-danger me-2"></i>Profitability may take longer than expected</li>
                                <% } else if(campaign.tokenType === 'ownership') { %>
                                    <li class="mb-2"><i class="bi bi-dot text-danger me-2"></i>Dilution risk in future funding rounds</li>
                                <% } %>
                            </ul>
                        </div>
                    </div>

                    <!-- Timeline -->
                    <div class="mb-5" data-aos="fade-up">
                        <h3 class="section-title">Project Timeline</h3>
                        <div class="timeline">
                            <div class="timeline-item">
                                <h5>Campaign Launch</h5>
                                <p class="text-muted"><%= new Date(campaign.timeCreated).toLocaleDateString() %></p>
                            </div>
                            <div class="timeline-item">
                                <h5>Funding Target Reached</h5>
                                <p class="text-muted">Estimated <%= new Date(Date.now() + 30*24*60*60*1000).toLocaleDateString() %></p>
                            </div>
                            <div class="timeline-item">
                                <h5>Project Development Starts</h5>
                                <p class="text-muted">After funding completion</p>
                            </div>
                            <% if(campaign.tokenType === 'profit') { %>
                                <div class="timeline-item">
                                    <h5>First Profit Distribution</h5>
                                    <p class="text-muted">Estimated <%= new Date(Date.now() + 120*24*60*60*1000).toLocaleDateString() %></p>
                                </div>
                            <% } %>
                        </div>
                    </div>

                    <!-- Investors Section -->
                    <div class="investors-section" data-aos="fade-up">
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <h3 class="section-title">Recent Investors</h3>
                            <span class="badge bg-primary rounded-pill px-3 py-2">
                                <i class="bi bi-people me-1"></i> <%= campaign.investments ? campaign.investments.length : 0 %> Investors
                            </span>
                        </div>
                        
                        <% if (campaign.investments && campaign.investments.length > 0) { %>
                            <div class="row">
                                <% campaign.investments.slice(0, 6).forEach(investment => { %>
                                    <div class="col-md-6 mb-4">
                                        <div class="investor-card">
                                            <div class="d-flex align-items-start">
                                                <img src="<%= investment.investor.profilePicture || '/images/default-avatar.png' %>" 
                                                     alt="<%= investment.investor.username %>" 
                                                     class="investor-avatar me-3">
                                                <div class="flex-grow-1">
                                                    <h5 class="mb-1">
                                                        <%= investment.investor.username %> <%= investment.investor.surname %>
                                                    </h5>
                                                    <p class="mb-2 text-muted small">
                                                        <i class="bi bi-cash-coin me-1"></i> Invested <strong>$<%= investment.amount.toLocaleString() %></strong>
                                                    </p>
                                                    <p class="mb-3 text-muted small">
                                                        <i class="bi bi-coin me-1"></i> Received <strong><%= investment.tokens.toLocaleString() %> <%= campaign.tokenSymbol %></strong>
                                                    </p>
                                                    <div class="d-flex justify-content-between align-items-center">
                                                        <small class="text-muted">
                                                            <i class="bi bi-clock me-1"></i> <%= new Date(investment.timeCreated).toLocaleDateString() %>
                                                        </small>
                                                        <a href="/<%= investment.transactionHash %>/blockchain" 
                                                           target="_blank" 
                                                           class="btn btn-sm btn-outline-primary">
                                                            <i class="bi bi-blockchain"></i> View Tx
                                                        </a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                <% }); %>
                            </div>
                            
                            <% if (campaign.investments.length > 6) { %>
                                <div class="text-center mt-4">
                                    <a href="#" class="btn btn-outline-primary px-4">
                                        <i class="bi bi-arrow-down-circle me-2"></i>Show All Investors
                                    </a>
                                </div>
                            <% } %>
                        <% } else { %>
                            <div class="card shadow-sm">
                                <div class="card-body text-center py-5">
                                    <i class="bi bi-people" style="font-size: 3rem; color: #adb5bd;"></i>
                                    <h4 class="mt-3">No investments yet</h4>
                                    <p class="text-muted">Be the first to invest in this promising campaign!</p>
                                    <% if(campaign.status === 'active') { %>
                                        <a href="#investNow" class="btn btn-primary mt-3 px-4">
                                            <i class="bi bi-currency-dollar me-2"></i>Invest Now
                                        </a>
                                    <% } %>
                                </div>
                            </div>
                        <% } %>
                    </div>
                </div>

                <!-- Right Column - Investment Action -->
                <div class="col-lg-4">
                    <div class="card investment-card shadow-lg" id="investNow" data-aos="fade-left">
                        <div class="card-body">
                            <h4 class="card-title mb-4">
                                <i class="bi bi-currency-dollar me-2"></i>Invest in this Campaign
                            </h4>
                            
                            <% if(campaign.status !== 'active') { %>
                                <div class="alert alert-warning">
                                    <i class="bi bi-exclamation-triangle me-2"></i>
                                    This campaign is no longer accepting investments.
                                </div>
                            <% } else { %>
                                <form id="investmentForm" action="/campaigns/invest" method="POST">
                                    <input type="hidden" name="campaignId" value="<%= campaign._id %>">
                                    
                                    <div class="mb-4">
                                        <label for="investmentAmount" class="form-label fw-bold mb-3">Investment Amount ($)</label>
                                        <input type="number" class="form-control form-control-lg py-3" id="investmentAmount" 
                                               name="amount" min="1" required placeholder="1000">
                                        <div class="d-flex justify-content-between mt-2 text-muted small">
                                            <span>$100</span>
                                            <span>$5,000</span>
                                            <span>$10,000+</span>
                                        </div>
                                    </div>
                                    
                                    <!-- Token Calculator -->
                                    <div class="token-calculator">
                                        <h6 class="mb-3 text-center fw-bold">Your Investment Summary</h6>
                                        <div class="calculator-result" id="tokenEstimate">
                                            <% if(campaign.tokenType === 'profit') { %>
                                                1 <%= campaign.tokenSymbol %> = $1
                                            <% } else if(campaign.tokenType === 'ownership') { %>
                                                1 <%= campaign.tokenSymbol %> = $<%= (campaign.goalAmount * (campaign.tokenMetadata.ownershipPercentage/100) / campaign.totalTokens).toFixed(4) %>
                                            <% } else if(campaign.tokenType === 'rewards') { %>
                                                Tokens grant rewards
                                            <% } else if(campaign.tokenType === 'hybrid') { %>
                                                Each token gives <%= campaign.tokenMetadata.ownershipPerToken %>% + rewards
                                            <% } %>
                                        </div>
                                    </div>
                                    
                                    <div class="alert alert-info mt-4">
                                        <small>
                                            <i class="bi bi-info-circle me-2"></i> 
                                            <% if(campaign.tokenType === 'profit') { %>
                                                You'll receive 1 <%= campaign.tokenSymbol %> token for every $1 invested, entitling you to a share of <%= campaign.tokenMetadata.profitSharePercentage %>% of project profits.
                                            <% } else if(campaign.tokenType === 'ownership') { %>
                                                Each token represents partial ownership in the project. Total <%= campaign.tokenMetadata.ownershipPercentage %>% equity is being offered.
                                            <% } else if(campaign.tokenType === 'rewards') { %>
                                                Tokens grant access to: <%= campaign.tokenMetadata.rewardDescription.substring(0, 60) %>...
                                            <% } else if(campaign.tokenType === 'hybrid') { %>
                                                Each token gives <%= campaign.tokenMetadata.ownershipPerToken %>% ownership plus additional rewards.
                                            <% } %>
                                        </small>
                                    </div>
                                    
                                    <% if(currentUser) { %>
                                        <button type="submit" class="btn btn-invest w-100 mt-4 py-3 fw-bold">
                                            <i class="bi bi-lightning-charge me-2"></i> INVEST NOW
                                        </button>
                                    <% } else { %>
                                        <a href="/login" class="btn btn-primary w-100 mt-4 py-3 fw-bold">
                                            <i class="bi bi-box-arrow-in-right me-2"></i> LOGIN TO INVEST
                                        </a>
                                    <% } %>
                                </form>
                            <% } %>
                            
                            <hr class="my-4">
                            
                            <div class="text-center">
                                <small class="text-muted d-flex align-items-center justify-content-center">
                                    <i class="bi bi-shield-lock me-2"></i> All investments are secured on the blockchain
                                </small>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Quick Stats -->
                    <div class="card shadow-sm mt-4" data-aos="fade-left" data-aos-delay="100">
                        <div class="card-body">
                            <h5 class="card-title mb-4 fw-bold">
                                <i class="bi bi-graph-up me-2"></i>Campaign Stats
                            </h5>
                            <div class="d-flex justify-content-between align-items-center mb-3 pb-2 border-bottom">
                                <span class="text-muted">
                                    <i class="bi bi-people me-2"></i>Investors:
                                </span>
                                <span class="fw-bold"><%= campaign.investors ? campaign.investors.length : 0 %></span>
                            </div>
                            <div class="d-flex justify-content-between align-items-center mb-3 pb-2 border-bottom">
                                <span class="text-muted">
                                    <i class="bi bi-calendar me-2"></i>Created:
                                </span>
                                <span><%= new Date(campaign.timeCreated).toLocaleDateString() %></span>
                            </div>
                            <div class="d-flex justify-content-between align-items-center mb-3 pb-2 border-bottom">
                                <span class="text-muted">
                                    <i class="bi bi-clock me-2"></i>Days Left:
                                </span>
                                <span>30</span>
                            </div>
                            <div class="d-flex justify-content-between align-items-center">
                                <span class="text-muted">
                                    <i class="bi bi-coin me-2"></i>Token Price:
                                </span>
                                <span class="fw-bold">$<%= (campaign.goalAmount / campaign.totalTokens).toFixed(2) %></span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Documents -->
                    <div class="card shadow-sm mt-4" data-aos="fade-left" data-aos-delay="200">
                        <div class="card-body">
                            <h5 class="card-title mb-4 fw-bold">
                                <i class="bi bi-file-earmark-text me-2"></i>Documents
                            </h5>

                            <h4>📄 Investor Documents</h4>
                            <ul>
                              <% if (campaign.investorDocuments && campaign.investorDocuments.length > 0) { %>
                                <% campaign.investorDocuments.forEach(doc => { 
                                    const fileName = doc.originalName || doc.filename || '';
                                    const isPDF = fileName.toLowerCase().endsWith('.pdf');
                                    const isImage = /\.(jpg|jpeg|png)$/i.test(doc.originalName);
                                  %>
                            </ul>
                            <div class="d-flex align-items-center mb-3">
                                <i class="<%= isPDF ? 'bi-file-earmark-pdf-fill text-danger' : isImage ? 'bi-file-earmark-image-fill text-info' : 'bi-file-earmark-fill' %> fs-4 me-3 bi"></i>
                                <div>
                                    <h6 class="mb-0"><%= doc.originalName %> </h6>
                                    <small class="text-muted">PDF • 2.4 MB</small>
                                </div>
                                <a href="<%= doc.filename %>" class="ms-auto btn btn-sm btn-outline-primary">View</a>
                                <% if (currentUser && currentUser._id.toString() === campaign.owner._id.toString()) { %>
                                    <form action="/campaigns/<%= campaign._id %>/remove-doc/<%= doc._id %>" method="POST" style="display:inline;">
                                      <button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('Remove this file?')">🗑️</button>
                                    </form>
                                  <% } %>
                            </div>
      



                            <% }) %>
                            <% } else { %>
                              <p>No documents uploaded.</p>
                            <% } %>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

<!-- //////////////////////////////////////////////////////////////////////////////////////////////////////////
 /////////////////////////////////////////////////////////////////////////////////////////////////////////////--> 

    <form action="/campaigns/<%= campaign._id %>/upload-docs" method="POST" enctype="multipart/form-data">
        <label>Upload Investor Documents (PDF/JPG/PNG):</label><br />
        <input type="file" name="docs" multiple required />
        <button type="submit">Upload</button>
      </form>

      <form action="/campaigns/<%= campaign._id %>/rate" method="POST">
        <label>Risk Level (1-5):</label>
        <input type="number" name="riskScore" min="1" max="5" required>
        
        <label>Execution Score (1-5):</label>
        <input type="number" name="executionScore" min="1" max="5" required>
      
        <label>Optional Comment:</label>
        <textarea name="comment"></textarea>
      
        <button type="submit">Submit Rating</button>
      </form>

      <form action="/campaigns/<%= campaign._id %>/rate" method="POST">
        <h5>⭐ Rate This Campaign</h5>
      
        <!-- Risk Rating -->
        <label>Risk Level:</label>
        <div class="star-rating" data-type="risk">
          <% for (let i = 1; i <= 5; i++) { %>
            <i class="bi bi-star" data-value="<%= i %>" data-type="risk"></i>
          <% } %>
          <input type="hidden" name="riskScore" id="riskScore" required>
        </div>
      
        <!-- Execution Rating -->
        <label>Execution Score:</label>
        <div class="star-rating" data-type="execution">
          <% for (let i = 1; i <= 5; i++) { %>
            <i class="bi bi-star" data-value="<%= i %>" data-type="execution"></i>
          <% } %>
          <input type="hidden" name="executionScore" id="executionScore" required>
        </div>
      
        <label>Optional Comment:</label>
        <textarea name="comment" class="form-control"></textarea>
      
        <button type="submit" class="btn btn-primary mt-2">Submit Rating</button>
      </form>
      
      

      <h5>🌟 Community Ratings</h5>
      <% if (campaign.ratings && campaign.ratings.length > 0) { %>
        <p>Average Risk:
          <%= (campaign.ratings.reduce((sum, r) => sum + r.riskScore, 0) / campaign.ratings.length).toFixed(1) %>/5
        </p>
        <p>Average Execution:
          <%= (campaign.ratings.reduce((sum, r) => sum + r.executionScore, 0) / campaign.ratings.length).toFixed(1) %>/5
        </p>
        <ul>
          <% campaign.ratings.forEach(r => { %>
            <li>
              <strong><%= r.role %></strong>: Risk <%= r.riskScore %>/5, Execution <%= r.executionScore %>/5
              <br><em><%= r.comment %></em>
            </li>
          <% }) %>
        </ul>
      <% } else { %>
        <p>No ratings yet.</p>
      <% } %>
      
      

<!-- //////////////////////////////////////////////////////////////////////////////////////////////////////////
 /////////////////////////////////////////////////////////////////////////////////////////////////////////////--> 


    <!-- Edit Campaign Modal -->
    <div class="modal fade" id="editCampaignModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Edit Campaign</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form action="/campaigns/<%=campaign._id%>" method="POST" enctype="multipart/form-data">
                    <div class="modal-body">
                        <ul class="nav nav-tabs mb-4" id="editCampaignTabs" role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active" id="basic-tab" data-bs-toggle="tab" data-bs-target="#basic" type="button">Basic Info</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="token-tab" data-bs-toggle="tab" data-bs-target="#token" type="button">Token Details</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="media-tab" data-bs-toggle="tab" data-bs-target="#media" type="button">Media</button>
                            </li>
                        </ul>
                        
                        <div class="tab-content" id="editCampaignTabsContent">
                            <!-- Basic Info Tab -->
                            <div class="tab-pane fade show active" id="basic" role="tabpanel">
                                <div class="mb-4">
                                    <label for="title" class="form-label">Campaign Title</label>
                                    <input type="text" class="form-control" id="title" name="title" value="<%= campaign.title %>" required>
                                </div>
                                <div class="mb-4">
                                    <label for="description" class="form-label">Description</label>
                                    <textarea class="form-control" id="description" name="description" rows="6" required><%= campaign.description %></textarea>
                                </div>
                                <div class="row">
                                    <div class="col-md-6 mb-4">
                                        <label for="goalAmount" class="form-label">Goal Amount ($)</label>
                                        <input type="number" class="form-control" id="goalAmount" name="goalAmount" value="<%= campaign.goalAmount %>" required>
                                    </div>
                                    <div class="col-md-6 mb-4">
                                        <label for="status" class="form-label">Status</label>
                                        <select class="form-select" id="status" name="status">
                                            <option value="active" <%= campaign.status === 'active' ? 'selected' : '' %>>Active</option>
                                            <option value="funded" <%= campaign.status === 'funded' ? 'selected' : '' %>>Funded</option>
                                            <option value="closed" <%= campaign.status === 'closed' ? 'selected' : '' %>>Closed</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Token Details Tab -->
                            <div class="tab-pane fade" id="token" role="tabpanel">
                                <div class="mb-4">
                                    <label for="tokenName" class="form-label">Token Name</label>
                                    <input type="text" class="form-control" id="tokenName" name="tokenName" value="<%= campaign.tokenName %>" required>
                                </div>
                                <div class="mb-4">
                                    <label for="tokenSymbol" class="form-label">Token Symbol</label>
                                    <input type="text" class="form-control" id="tokenSymbol" name="tokenSymbol" value="<%= campaign.tokenSymbol %>" required>
                                </div>
                                <div class="mb-4">
                                    <label for="totalTokens" class="form-label">Total Tokens</label>
                                    <input type="number" class="form-control" id="totalTokens" name="totalTokens" value="<%= campaign.totalTokens %>" required>
                                </div>
                                
                                <div class="mb-4">
                                    <label class="form-label">Token Type</label>
                                    <div class="token-type-selector">
                                        <label class="token-type-option <%= campaign.tokenType === 'profit' ? 'active' : '' %>">
                                            <input type="radio" name="tokenType" value="profit" <%= campaign.tokenType === 'profit' ? 'checked' : '' %> required>
                                            <i class="bi bi-percent d-block" style="font-size: 1.5rem;"></i>
                                            <span>Profit Sharing</span>
                                        </label>
                                        <label class="token-type-option <%= campaign.tokenType === 'ownership' ? 'active' : '' %>">
                                            <input type="radio" name="tokenType" value="ownership" <%= campaign.tokenType === 'ownership' ? 'checked' : '' %>>
                                            <i class="bi bi-pie-chart d-block" style="font-size: 1.5rem;"></i>
                                            <span>Ownership</span>
                                        </label>
                                        <label class="token-type-option <%= campaign.tokenType === 'rewards' ? 'active' : '' %>">
                                            <input type="radio" name="tokenType" value="rewards" <%= campaign.tokenType === 'rewards' ? 'checked' : '' %>>
                                            <i class="bi bi-gift d-block" style="font-size: 1.5rem;"></i>
                                            <span>Rewards</span>
                                        </label>
                                        <label class="token-type-option <%= campaign.tokenType === 'hybrid' ? 'active' : '' %>">
                                            <input type="radio" name="tokenType" value="hybrid" <%= campaign.tokenType === 'hybrid' ? 'checked' : '' %>>
                                            <i class="bi bi-collection d-block" style="font-size: 1.5rem;"></i>
                                            <span>Hybrid</span>
                                        </label>
                                    </div>
                                </div>
                                
                                <!-- Dynamic Token Metadata Sections -->
                                <div class="token-metadata-section <%= campaign.tokenType === 'profit' ? 'active' : '' %>" id="profitMetadata">
                                    <h5 class="mb-4">Profit Sharing Details</h5>
                                    <div class="mb-4">
                                        <label for="profitSharePercentage" class="form-label">Profit Share Percentage</label>
                                        <div class="input-group">
                                            <input type="number" class="form-control" id="profitSharePercentage" name="tokenMetadata[profitSharePercentage]" 
                                                   value="<%= campaign.tokenType === 'profit' ? campaign.tokenMetadata.profitSharePercentage : '' %>">
                                            <span class="input-group-text">%</span>
                                        </div>
                                    </div>
                                    <div class="mb-4">
                                        <label class="form-label">Profit Base</label>
                                        <div class="form-check mb-2">
                                            <input class="form-check-input" type="radio" name="tokenMetadata[profitBase]" id="grossProfit" value="gross"
                                                <%= campaign.tokenType === 'profit' && campaign.tokenMetadata.profitBase === 'gross' ? 'checked' : '' %>>
                                            <label class="form-check-label" for="grossProfit">Gross Revenue</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="tokenMetadata[profitBase]" id="netProfit" value="net"
                                                <%= campaign.tokenType === 'profit' && campaign.tokenMetadata.profitBase === 'net' ? 'checked' : '' %>>
                                            <label class="form-check-label" for="netProfit">Net Profit</label>
                                        </div>
                                    </div>
                                    <div class="mb-4">
                                        <label for="profitDistributionFrequency" class="form-label">Distribution Frequency</label>
                                        <select class="form-select" id="profitDistributionFrequency" name="tokenMetadata[profitDistributionFrequency]">
                                            <option value="monthly" <%= campaign.tokenType === 'profit' && campaign.tokenMetadata.profitDistributionFrequency === 'monthly' ? 'selected' : '' %>>Monthly</option>
                                            <option value="quarterly" <%= campaign.tokenType === 'profit' && campaign.tokenMetadata.profitDistributionFrequency === 'quarterly' ? 'selected' : '' %>>Quarterly</option>
                                            <option value="annually" <%= campaign.tokenType === 'profit' && campaign.tokenMetadata.profitDistributionFrequency === 'annually' ? 'selected' : '' %>>Annually</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="token-metadata-section <%= campaign.tokenType === 'ownership' ? 'active' : '' %>" id="ownershipMetadata">
                                    <h5 class="mb-4">Ownership Details</h5>
                                    <div class="mb-4">
                                        <label for="ownershipPercentage" class="form-label">Ownership Percentage</label>
                                        <div class="input-group">
                                            <input type="number" class="form-control" id="ownershipPercentage" name="tokenMetadata[ownershipPercentage]" 
                                                   value="<%= campaign.tokenType === 'ownership' ? campaign.tokenMetadata.ownershipPercentage : '' %>">
                                            <span class="input-group-text">%</span>
                                        </div>
                                    </div>
                                    <div class="mb-4 form-check">
                                        <input type="checkbox" class="form-check-input" id="votingRights" name="tokenMetadata[votingRights]"
                                            <%= campaign.tokenType === 'ownership' && campaign.tokenMetadata.votingRights ? 'checked' : '' %>>
                                        <label class="form-check-label" for="votingRights">Include Voting Rights</label>
                                    </div>
                                </div>
                                
                                <div class="token-metadata-section <%= campaign.tokenType === 'rewards' ? 'active' : '' %>" id="rewardsMetadata">
                                    <h5 class="mb-4">Rewards Details</h5>
                                    <div class="mb-4">
                                        <label for="rewardDescription" class="form-label">Reward Description</label>
                                        <textarea class="form-control" id="rewardDescription" name="tokenMetadata[rewardDescription]" rows="4"><%= campaign.tokenType === 'rewards' ? campaign.tokenMetadata.rewardDescription : '' %></textarea>
                                    </div>
                                </div>
                                
                                <div class="token-metadata-section <%= campaign.tokenType === 'hybrid' ? 'active' : '' %>" id="hybridMetadata">
                                    <h5 class="mb-4">Hybrid Token Details</h5>
                                    <div class="mb-4">
                                        <label for="ownershipPerToken" class="form-label">Ownership Per Token</label>
                                        <div class="input-group">
                                            <input type="number" step="0.0001" class="form-control" id="ownershipPerToken" name="tokenMetadata[ownershipPerToken]" 
                                                   value="<%= campaign.tokenType === 'hybrid' ? campaign.tokenMetadata.ownershipPerToken : '' %>">
                                            <span class="input-group-text">%</span>
                                        </div>
                                    </div>
                                    <div class="mb-4">
                                        <label for="hybridRewardDescription" class="form-label">Additional Reward Description</label>
                                        <textarea class="form-control" id="hybridRewardDescription" name="tokenMetadata[rewardDescription]" rows="4"><%= campaign.tokenType === 'hybrid' ? campaign.tokenMetadata.rewardDescription : '' %></textarea>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Media Tab -->
                            <div class="tab-pane fade" id="media" role="tabpanel">
                                <div class="mb-4">
                                    <label for="image" class="form-label">Campaign Banner Image</label>
                                    <input class="form-control" type="file" id="image" name="image" accept="image/*">
                                    <% if(campaign.image) { %>
                                        <div class="mt-3">
                                            <small>Current Image:</small>
                                            <img src="<%= campaign.image %>" alt="Current banner" class="img-thumbnail mt-2" style="max-height: 150px;">
                                        </div>
                                    <% } %>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="submit" class="btn btn-primary">Save Changes</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
    <script>
        // Initialize animations
        AOS.init({
            duration: 800,
            easing: 'ease-in-out',
            once: true
        });
        
        // Calculate token estimate
        document.getElementById('investmentAmount')?.addEventListener('input', function(e) {
            const amount = parseFloat(e.target.value);
            const tokenEstimate = document.getElementById('tokenEstimate');
            
            if (!isNaN(amount) && amount > 0) {
                <% if(campaign.tokenType === 'profit') { %>
                    const tokens = amount; // 1 token per $1
                    tokenEstimate.innerHTML = `${tokens.toLocaleString()} <%= campaign.tokenSymbol %> tokens`;
                <% } else if(campaign.tokenType === 'ownership') { %>
                    const tokenValue = <%= (campaign.goalAmount * (campaign.tokenMetadata.ownershipPercentage/100) / campaign.totalTokens) %>;
                    const tokens = amount / tokenValue;
                    tokenEstimate.innerHTML = `${tokens.toFixed(2).toLocaleString()} <%= campaign.tokenSymbol %> tokens (${(tokens * <%= campaign.tokenMetadata.ownershipPercentage %> / <%= campaign.totalTokens %>).toFixed(4)}% ownership)`;
                <% } else if(campaign.tokenType === 'rewards') { %>
                    tokenEstimate.innerHTML = `${amount.toLocaleString()} <%= campaign.tokenSymbol %> tokens`;
                <% } else if(campaign.tokenType === 'hybrid') { %>
                    tokenEstimate.innerHTML = `${amount.toLocaleString()} <%= campaign.tokenSymbol %> tokens (${(amount * <%= campaign.tokenMetadata.ownershipPerToken %>).toFixed(4)}% total ownership)`;
                <% } %>
            } else {
                // Reset to default message
                <% if(campaign.tokenType === 'profit') { %>
                    tokenEstimate.innerHTML = `1 <%= campaign.tokenSymbol %> = $1`;
                <% } else if(campaign.tokenType === 'ownership') { %>
                    tokenEstimate.innerHTML = `1 <%= campaign.tokenSymbol %> = $<%= (campaign.goalAmount * (campaign.tokenMetadata.ownershipPercentage/100) / campaign.totalTokens).toFixed(4) %>`;
                <% } else if(campaign.tokenType === 'rewards') { %>
                    tokenEstimate.innerHTML = `Tokens grant rewards`;
                <% } else if(campaign.tokenType === 'hybrid') { %>
                    tokenEstimate.innerHTML = `Each token gives <%= campaign.tokenMetadata.ownershipPerToken %>% + rewards`;
                <% } %>
            }
        });
        
        // Form validation
        document.getElementById('investmentForm')?.addEventListener('submit', function(e) {
            const amountInput = document.getElementById('investmentAmount');
            if (!amountInput.value || parseFloat(amountInput.value) <= 0) {
                e.preventDefault();
                amountInput.classList.add('is-invalid');
                return false;
            }
            return true;
        });
        
        // Token type selector functionality for edit modal
        document.querySelectorAll('input[name="tokenType"]').forEach(radio => {
            radio.addEventListener('change', function() {
                // Hide all metadata sections
                document.querySelectorAll('.token-metadata-section').forEach(section => {
                    section.classList.remove('active');
                });
                
                // Show the selected metadata section
                const selectedType = this.value;
                document.getElementById(`${selectedType}Metadata`).classList.add('active');
                
                // Update active class on options
                document.querySelectorAll('.token-type-option').forEach(option => {
                    option.classList.remove('active');
                });
                this.closest('.token-type-option').classList.add('active');
            });
        });
        
        // Delete confirmation
        function confirmDelete(campaignId) {
            if(confirm('Are you sure you want to delete this campaign? This action cannot be undone.')) {
                fetch(`/campaigns/${campaignId}`, {
                    method: 'DELETE'
                }).then(response => {
                    if(response.ok) {
                        window.location.href = '/campaigns';
                    } else {
                        alert('Failed to delete campaign');
                    }
                });
            }
        }
        
        // Initialize the edit modal with the correct token type selected
        document.addEventListener('DOMContentLoaded', function() {
            const editModal = document.getElementById('editCampaignModal');
            if (editModal) {
                editModal.addEventListener('show.bs.modal', function() {
                    // Ensure the correct token metadata section is visible
                    const currentTokenType = '<%= campaign.tokenType %>';
                    document.querySelectorAll('.token-metadata-section').forEach(section => {
                        section.classList.remove('active');
                    });
                    document.getElementById(`${currentTokenType}Metadata`).classList.add('active');
                });
            }
        });
    </script>

<script>
    document.querySelectorAll('.star-rating').forEach(group => {
      const stars = group.querySelectorAll('i');
      const input = group.querySelector('input');
      const type = group.getAttribute('data-type');
  
      stars.forEach(star => {
        star.addEventListener('click', () => {
          const value = star.getAttribute('data-value');
          input.value = value;
  
          // Update star UI
          stars.forEach(s => {
            const v = s.getAttribute('data-value');
            s.className = `bi ${v <= value ? 'bi-star-fill text-warning' : 'bi-star'}`;
          });
        });
      });
    });
  </script>
  
</body>
</html>
